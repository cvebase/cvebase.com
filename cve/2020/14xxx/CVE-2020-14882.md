---
id: CVE-2020-14882
pocs:
  - https://raw.githubusercontent.com/projectdiscovery/nuclei-templates/master/cves/2020/CVE-2020-14882.yaml
  - https://github.com//jas502n//CVE-2020-14882
  - https://github.com/0thm4n3/cve-2020-14882
  - https://github.com/AirEvan/CVE-2020-14882-GUI-Test
  - https://github.com/BabyTeam1024/CVE-2020-14882
  - https://github.com/GGyao/CVE-2020-14882
  - https://github.com/GGyao/CVE-2020-14882_ALL
  - https://github.com/GGyao/CVE-2020-14882_POC
  - https://github.com/NS-Sp4ce/CVE-2020-14882
  - https://github.com/QmF0c3UK/CVE-2020-14882
  - https://github.com/RedTeamWing/CVE-2020-14882
  - https://github.com/ShmilySec/CVE-2020-14882
  - https://github.com/Umarovm/-Patched-McMaster-University-Blind-Command-Injection
  - https://github.com/Umarovm/McMaster-University-0-day-Blind-Command-Injection
  - https://github.com/alexfrancow/CVE-2020-14882
  - https://github.com/corelight/CVE-2020-14882-weblogicRCE
  - https://github.com/jas502n/CVE-2020-14882
  - https://github.com/ludy-dev/Weblogic_Unauthorized-bypass-RCE
  - https://github.com/mmioimm/cve-2020-14882
  - https://github.com/murataydemir/CVE-2020-14882
  - https://github.com/ovProphet/CVE-2020-14882-checker
  - https://github.com/pwn3z/CVE-2020-14882-WebLogic
  - https://github.com/s1kr10s/CVE-2020-14882
  - https://github.com/securitysqs/poc
  - https://github.com/sickwell/CVE-2020-14882
  - https://github.com/wsfengfan/cve-2020-14882
  - https://github.com/x51/CVE-2020-14882
  - https://github.com/xkx518/CodeTest
  - https://github.com/zhzyker/exphub
  - https://github.com/zhzyker/vulmap
  - https://raw.githubusercontent.com/jaeles-project/jaeles-signatures/master/cves/oracle-weblogic-console-rce-cve-2020-14882.yaml
  - https://raw.githubusercontent.com/jaeles-project/jaeles-signatures/master/cves/oracle-weblogic-console-rce-probe-cve-2020-14882.yaml
  - https://raw.githubusercontent.com/jaeles-project/jaeles-signatures/master/cves/oracle-weblogic-rce-cve-2020-14882.yaml  - https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/multi/http/weblogic_admin_handle_rce.rb
writeups:
  - https://testbnull.medium.com/weblogic-rce-by-only-one-get-request-cve-2020-14882-analysis-6e4b09981dbf
  - https://www.youtube.com/watch?v=JFVDOIL0YtA
  - https://www.youtube.com/watch?v=t-sxvcZNFZo
---
Oracle Weblogic unauthorized bypass RCE via only one GET request* CVSS: 9.8/10 (CRITICAL)
* Protocol: HTTP
* Affects all versionsThis is a translated summary of [Jang @testanull](https://twitter.com/testanull/status/1321390624042442753)'s writeup (in Vietnamese), analyzing Oracle Weblogic 12.2.1.3. Focus on the class files modified in the patch (October patch has number 3191038, diff with July patch 31535411): 
* `HandleFactory.class`
* `MBeanUtilsInitSingleFileServlet.class`## The Sink This patch of `HandleFactory` checks the `handleClass` type, allowing only instances of `com.bea.console.handles.Handle`. According to the flow of the `HandleFactory.getHandle()` method, the input data is a String, and after processing it will reach `Class.forName (className)` to load this class. Next will look for a constructor with 1 argument of type String to create a new instance from there. It is possible to trigger entrypoint with the following HTTP GET request (but this piece still needs to be authenticated first):
 ```
 http://<target>/console/console.portal?_nfpb=true&_pageLabel=HomePage1&handle=java.lang.String("ahihi")
 ```Setting the breakpoint at `HandleFactory.getHandle()`, the values of `handleConstructor` `args` are all controlled from the input data.To take advantage of this entrypoint, it is necessary to find a class that contains a public Constructor with 1 argument of type String.## The SourceWith `HandleFactory.getHandle()` as the sink of this bug, then it is reasonable to assume the remaining patched class `MBeanUtilsInitSingleFileServlet` is the source of the bug.The patched class has an additional field `IllegalUrl` as follows:
```
private static final String[] IllegalUrl = new String[]{";", "%252E%252E", "%2E%2E", "..", "%3C", "%3E", "<", ">"};
```Note that the code of this servlet handle merely checks for existence on the url string `..`, and if not, will reject this request.An additional authentication step is required in order to reach `MBeanUtilsInitSingleFileServlet.service()`.This url can trigger `MBeanUtilsInitSingleFileServlet` without any authentication:
```
/console/css/changemgmt.portal
```Mapping to `/css/` is unrestricted, and `AsyncInitServlet` can be the servlet handle, not `FileServlet` as is the case for .css extension.As declared by static resource declaration of `web.xml`:
* Url pattern `/common/*` is handled by `JSPCServlet` (handles requests to jsp files)
* The `/framework/*` pattern urls are handled by `FileServlet`
* There is no declaration of which servlet will handle urls patterns `/images/*` and `/css/*`So when a request with the url `/console/css/aaasdasdasd.portal`, `AppManagerServlet` will handle this request. By traversing `/css/*` to bypass authentication and `*.portal` to trigger, `MBeanUtilsInitSingleFileServlet.service()` is able to reach `MBeanUtilsInitSingleFileServlet.service()` without authentication. However, the request still cannot reach `HandleFactory.getHandle()` because the url pattern cannot match. So use a double encoded `..` to trigger a bug.Using a double encoded url can both bypass the original normalized url handler, and still get the servlet handler to work properly afterwards.## Trigger RCEUse `com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext()` to trigger the RCE with outbound.Also possible to find a new chain: no outbound required, RCE in one hit. Edit the `GadgetInspector` tool to serve the trace code. This chain after receiving argument from the constructor will call `ShellSession.exec()`, and chain execution with `MVEL.executeExpression()`.Thus, it is possible to execute an arbitrary MVEL expression.
